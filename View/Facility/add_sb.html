<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<script type="text/javascript" src="lib/PIE_IE678.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="__PUBLIC__/static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/lib/Hui-iconfont/1.0.7/iconfont.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/lib/icheck/icheck.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/static/h-ui.admin/css/style.css" />


<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
<!--/meta 作为公共模版分离出去-->

<title>添加设备</title>
<style type="text/css">
.clear{clear: both;height: 0;overflow: hidden;}
.col-sm-3 {
    width: 135px!important;
    text-align: right;
}
.col-sm-offset-3 {
    margin-left: 5%!important;
}
.row{padding: 8px 0!important;}
.table1 tr td{width: 50%;}
.tac{position: absolute;top: 60px;left: 135px;}
.box1{width: 750px;border: 3px solid #5a98de;background: #fff;}
.box_css{background: #eee;padding:6px 10px;}
.search{width: 210px;text-align: center;margin: 0 auto;padding: 10px 0;}
.search input{width: 125px;border: 1px solid #ddd;height: 30px;float: left;padding: 0 10px;}
.search button{width: 60px;height: 32px;;background: #5a98de;border: 0;color: #fff;float: left;}
.box_main{padding-bottom: 20px;}
.tt tr{height: 40px;line-height: 40px;}
.tt tr th{text-align: center;border-right: 1px solid #ddd}
.bj{border: 1px solid #ddd;background: #f5fafe;border-right: none;border-left: none;}
.tt tr td{text-align: center;border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;}
.fy{text-align: center;margin-top: 20px;}
.fy a{display: inline-block;padding: 6px 10px;border: 1px solid #ddd;}
.actt{background: #5a98de;color: #fff;}
.fy a:hover{background: #5a98de;color: #fff;}
.hd{display: none;}
.sh{display: block;}
</style>
</head>
<body style="width: 100%;">
<div class="cl pd-5 bg-1 bk-gray mt-20">
		<span class="l"><a class="btn btn-primary radius" href="{:U('facility/facility_list')}">设备列表</a></span>
		
		<!-- <div class="l hah" style="margin-left: 30px;"><input type="text" placeholder="请输入关键字"><button type="button">GO</button></div> -->
	</div>
<article class="page-container">
<table class="table1" border="0">
<form action="" method="post" enctype="multipart/form-data">
	<tbody>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3" >通讯编号:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" maxlength="20"   name="dtuid" class="input-text" value="{$info.dtuid}" placeholder="" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">通讯名称:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" name="note" class="input-text" autocomplete="off" value="{$info.note}" >
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">主用户名称:</label>
					<div class="formControls col-xs-8 col-sm-9" onClick="userr('用户名称','{:U('facility/add_userr')}','100001','900','500')">
						<input type="text" name="customer_name" id="customer_name" class="input-text" autocomplete="off" value="{$info.userr}"   style="width: 60%;margin-bottom:20px">
				
						 <input type="hidden" id="customer_id" name="customer_id" value="{$info.customer_id}"><!--
						<input type="hidden" id="htid" name="htid" value="{$info.htid}">
						<input type="hidden" id="zeren_id" name="zeren_id" value="{$info.zeren_id}"> -->
					
					</div>
				<label class="form-label col-xs-4 col-sm-3">使用用户名称:</label>
					<div class="formControls col-xs-8 col-sm-9" onClick="userr('用户名称','{:U('facility/ad_userr')}','100001','900','500')">
						<input type="text" name="cname" id="cname" class="input-text" autocomplete="off" value="{$info.userr_id}"   style="width: 60%">
				
						 <input type="text" id="cid" name="cid" value="{$info.userr_id}">
				</div>
			</td>
			
			 
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">IP 地址:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" name="ipaddr" class="input-text" autocomplete="off" value="{$info.ipaddr}" style="width: 40%">
						<span>uport</span>
						<input type="text" name="uport" class="input-text"  value="{$info.uport}" style="width: 20%">
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">PLC方案:</label>
					<div class="formControls col-xs-8 col-sm-9"  onClick="plan('方案列表','{:U('facility/add_plan')}','100001','900','500')">
						<input type="text" class="input-text" id="planname"  value="{$info.planname}" style="width: 40%">
						<span>PLANID</span>
						<input type="text" name="planid" id="planid" class="input-text"  value="{$info.planid}" style="width: 20%">
						<span>PLCID</span>
						<input type="text" name="plcid" id="plcid" class="input-text"  value="{$info.plcid}" style="width: 20%">
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">心跳周期:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" name="heart_time" class="input-text" autocomplete="off" value="{$info.heart_time}" placeholder="请输入心跳周期，默认为300秒,60~65335秒">
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">产品型号:</label>
					<div class="formControls col-xs-8 col-sm-9" onClick="product('产品列表','{:U('facility/add_product')}','100001','900','500')">
						<input type="text" name="product_name"  id="product_name" class="input-text"  value="{$info.product_name}"  placeholder="" id="cpxh1">
						<input type="hidden" name="product_id" value="{$info.product_id}" id="product_id" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">交货时间:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" onfocus="WdatePicker()" value="{$info.jhtime}" name="jhtime" class="input-text" autocomplete="off"  placeholder="" >
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">启用时间:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" onfocus="WdatePicker()" value="{$info.qytime}" class="input-text" name="qytime" autocomplete="off"  placeholder="" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">注册时间:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" onfocus="WdatePicker()" value="{$info.regtime}" class="input-text" name="regtime" autocomplete="off"  placeholder="设备第一次连接的时间" >
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">更新时间:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" onfocus="WdatePicker()" value="{$info.uptime}" class="input-text" name="uptime" autocomplete="off"  placeholder="" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">出厂编号:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" class="input-text" name="product_code" value="{$info.product_code}" placeholder="" >
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">自定解析:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" name="rule" class="input-text" value="{$info.rule}" placeholder="" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">原理图:</label>
					<div class="formControls col-xs-8 col-sm-9">
					<input type="file" name="photo" class="input-text" value="{$info.photo}" placeholder="点击上传" style="width: 60%">
						<!-- <input type="file" class="input-text" placeholder="" style="display: none;" id="sc">
						<label  for="sc" style="color: #c20919;cursor: pointer;">上传</label> -->
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">设备有效:</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
						<select class="select" name="available" size="1">
							<option value="1" <eq name="info.available" value="1">selected=""</eq> >正常</option>
							<option value="0" <eq name="info.available" value="0">selected=""</eq> >禁用</option>
						</select>
						</span> </div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">活动状态:</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
						<select class="select"  name="istatus" size="1">
							<option value="1" <eq name="info.istatus" value="1">selected=""</eq> >正常</option>
							<option value="0" <eq name="info.istatus" value="0">selected=""</eq> >停止</option>
						</select>
						</span> </div>
				</div>
			</td>
		</tr>
		<tr>
			
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">审核状态:</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
						<select class="select"  name="shenhe" size="1">
							<option value="0" <eq name="info.shenhe" value="0">selected=""</eq> >调试中</option>
							<option value="1" <eq name="info.shenhe" value="1">selected=""</eq> >已审核</option>
						</select>
						</span> </div>
				</div>
				
			</td>
			<td><div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">运行状态:</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
						<select class="select"  name="run_status" size="1">
							<option value="0" <eq name="info.run_status" value="0">selected=""</eq> >停止</option>
							<option value="1" <eq name="info.run_status" value="1">selected=""</eq> >运行中</option>
						</select>
						</span> </div>
				</div></td>
		</tr>
		<tr>
			
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">报警功能:</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
						<select class="select"  name="tostaff" size="1">
						<option value="1" <eq name="info.tostaff" value="1">selected=""</eq> >通知工程师</option>
							<option value="0" <eq name="info.tostaff" value="0">selected=""</eq> >禁用</option>
							
						</select>
						</span> </div>
				</div>
				
			</td>
			<td><div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">通知客户:</label>
					<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
						<select class="select"  name="tocustom" size="1">
						<option value="1" <eq name="info.tocustom" value="1">selected=""</eq> >通知客户</option>
							<option value="0" <eq name="info.tocustom" value="0">selected=""</eq> >禁用</option>
							
						</select>
						</span> </div>
				</div></td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">数据卡号:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" value="{$info.mobile}" name="mobile" class="input-text" placeholder="" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">已用流量:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" name="usedflow" class="input-text" value="{$info.usedflow}" placeholder="本月已用流量" >
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">售后工程师:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" id="zeren_id" name="zeren_id" value="{$info.zeren_id}" class="input-text" disabled="true" placeholder="在合同里添加责任人" >
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">地图坐标:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<input type="text" style="width: 30%" id="adress" class="input-text" placeholder="请输入地址" >
						<button class="input-group-btn btn btn-primary radius" type="button" style="margin-left: 20px;">获取</button>
						<input type="text" id="xpoint" name="lng" value="{$info.lng}" class="input-text" placeholder="经度" style="width: 20%;margin-left: 20px;" readonly="readonly">
						<input type="text" id="ypoint" name="lat" value="{$info.lat}" class="input-text" placeholder="纬度" style="width: 20%;margin-left: 20px;" readonly="readonly">
						<div id="mapbox" class="divbox" style="display: none;"></div>
						
					</div>
					 
				</div>
			</td>
			
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">后台备注:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<textarea name="memo" cols="" rows="" class="textarea"  placeholder="说点什么...100个字符以内" dragonfly="true" onKeyUp="textarealength(this,100)">{$info.memo}</textarea>
						<p class="textarea-numberbar"><em class="textarea-length">0</em>/100</p>
					</div>
				</div>
			</td>
			<td>
				<div class="row cl">
					<label class="form-label col-xs-4 col-sm-3">用户概况:</label>
					<div class="formControls col-xs-8 col-sm-9">
						<textarea name="userinfo" cols="" rows="" class="textarea"  placeholder="说请填写用户情况" dragonfly="true" onKeyUp="textarealength(this,100)">{$info.userinfo}</textarea>
						<p class="textarea-numberbar"><em class="textarea-length">0</em>/100</p>
					</div>
				</div>
			</td>
			
		</tr>
		<tr>
			<td>
				<div class="row cl">
					<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
						<input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;提交&nbsp;&nbsp;">
					</div>
				</div>
			</td>
		</tr>
		
	</tbody>
</table>
</form>

<div id="qaq" style="display: none;position: fixed;top: 10%;left: 12%;">
	<div style="text-align: right;width: 100%;"><span id="close" class="btn btn-danger" style="cursor: pointer;">关闭</span></div>
    <div id="allmap" style="height: 500px;width: 600px;"></div>
</div>

</article>

<!--_footer 作为公共模版分离出去--> 
<script type="text/javascript" src="__PUBLIC__/lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="__PUBLIC__/lib/layer/2.1/layer.js"></script> 
<script type="text/javascript" src="__PUBLIC__/lib/icheck/jquery.icheck.min.js"></script> 
<script type="text/javascript" src="__PUBLIC__/lib/jquery.validation/1.14.0/jquery.validate.min.js"></script> 
<script type="text/javascript" src="__PUBLIC__/lib/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="__PUBLIC__/lib/jquery.validation/1.14.0/messages_zh.min.js"></script> 

<script type="text/javascript" src="__PUBLIC__/lib/My97DatePicker/WdatePicker.js"></script> 
<script type="text/javascript" src="__PUBLIC__/static/h-ui/js/H-ui.js"></script> 
<script type="text/javascript" src="__PUBLIC__/static/h-ui.admin/js/H-ui.admin.js"></script>
<!-- <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=FG8PGj2G7DMGzlauduuuGVlq"></script>  -->
<!--/_footer /作为公共模版分离出去--> 

<!--请在下方写此页面业务相关的脚本--> 
<script type="text/javascript">

$(function(){
	$('.skin-minimal input').iCheck({
		checkboxClass: 'icheckbox-blue',
		radioClass: 'iradio-blue',
		increaseArea: '20%'
	});
	
	$("#form-admin-add").validate({
		rules:{
			adminName:{
				required:true,
				minlength:4,
				maxlength:16
			},
			password:{
				required:true,
			},
			password2:{
				required:true,
				equalTo: "#password"
			},
			sex:{
				required:true,
			},
			phone:{
				required:true,
				isPhone:true,
			},
			email:{
				required:true,
				email:true,
			},
			adminRole:{
				required:true,
			},
		},
		onkeyup:false,
		focusCleanup:true,
		success:"valid",
		submitHandler:function(form){
			$(form).ajaxSubmit();
			var index = parent.layer.getFrameIndex(window.name);
			parent.$('.btn-refresh').click();
			parent.layer.close(index);
		}
	});
});
</script> 
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>
<script type="text/javascript">


function userr(title,url,id,w,h){
	layer_show(title,url,w,h);
}
function plan(title,url,id,w,h){
	layer_show(title,url,w,h);
}
function product(title,url,id,w,h){
	layer_show(title,url,w,h);
}
</script>

	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=67e0ab632a19fa222b5a452a6e81ad71"></script>
    <script>
    $(function(){ 
            var xpoint;
        var ypoint;
        var map = new BMap.Map("allmap");
        var x = 0;
        var y = 0;
        if (!x) {
            x = "{$info.lng|default='39.362873'}";
            y = "{$info.lat|default='115.893284'}";
        }
        var point = new BMap.Point(y, x);

        
        map.enableScrollWheelZoom(true);
        map.centerAndZoom(point, 16);
        var marker = new BMap.Marker(point);
        map.addOverlay(marker);
        marker.enableDragging();
        marker.addEventListener('dragend', function(e) {
            xpoint = e.point.lat;
            ypoint = e.point.lng;
            $('#xpoint').val(xpoint);
            $('#ypoint').val(ypoint);
        });
        xpoint = marker.point.lat;
        ypoint = marker.point.lng;
        $('#xpoint').val(xpoint);
        $('#ypoint').val(ypoint);

        function mapShow(adress) {
            var myGeo = new BMap.Geocoder();
            // 将地址解析结果显示在地图上,并调整地图视野
            myGeo.getPoint(adress, function(point) {
                if (point) {
                    map.centerAndZoom(point, 16);
                    var marker = new BMap.Marker(point);
                    map.addOverlay(marker);
                    marker.enableDragging();
                    marker.addEventListener('dragend', function(e) {
                        xpoint = e.point.lng;
                        ypoint = e.point.lat;
                        $('#xpoint').val(xpoint);
                        $('#ypoint').val(ypoint);
                    });
                    //console.log(marker.point.lat);
                    
                    xpoint = marker.point.lng;
                    ypoint = marker.point.lat;
                    $('#xpoint').val(xpoint);
                    $('#ypoint').val(ypoint);

                } else {
                    alert("您选择地址没有解析到结果!");
                }
            }, "杭州市");

        }
        $('.input-group-btn').click(function(){
            $('#allmap').height(500);
            $("#qaq").css("display","block")
            var adress = $('#adress').val();
            mapShow(adress);
        })

         $('#close').click(function() {
            $("#qaq").css("display","none")
        })



    });
</script>

